(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{397:function(e,a,s){"use strict";s.r(a);var t=s(19),n=Object(t.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"demo-speed-up-accessing-remote-files"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#demo-speed-up-accessing-remote-files"}},[e._v("#")]),e._v(" DEMO - Speed Up Accessing Remote Files")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://fluid-imgs.oss-cn-shanghai.aliyuncs.com/public/video/remote-file-accessing.mp4",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://fluid-imgs.oss-cn-shanghai.aliyuncs.com/public/imgs/remoteData_demo.png",alt:""}}),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("Powered by "),a("a",{attrs:{href:"https://www.alluxio.io",target:"_blank",rel:"noopener noreferrer"}},[e._v("Alluxio"),a("OutboundLink")],1),e._v(" and "),a("a",{attrs:{href:"https://github.com/libfuse/libfuse",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fuse"),a("OutboundLink")],1),e._v(", Fluid provides a simple way for users to access files stored in remote filesystems, just like accessing some ordinary file in local filesystems.\nWhat's more, with a powerful caching capability provided, users can enjoy a great speedup on accessing remote files especially for those that have a frequent access pattern.")]),e._v(" "),a("p",[e._v("This demo aims to show you an overview of all the features mentioned above.")]),e._v(" "),a("h2",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),a("p",[e._v("Before everything we are going to do, please refer to "),a("RouterLink",{attrs:{to:"/guide/get_started.html"}},[e._v("Installation Guide")]),e._v(" to install Fluid on your Kubernetes Cluster, and make sure all the components used by Fluid are ready like this:")],1),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get pod "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" fluid-system\nNAME                                  READY   STATUS    RESTARTS   AGE\nalluxioruntime-controller-5b64fdbbb-84pc6   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          8h\ncsi-nodeplugin-fluid-fwgjh                  "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          8h\ncsi-nodeplugin-fluid-ll8bq                  "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          8h\ndataset-controller-5b7848dbbb-n44dj         "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          8h\n")])])]),a("p",[e._v('Normally, you shall see a Pod named "controller-manager" and several Pods named "csi-nodeplugin".\nThe num of "csi-nodeplugin" Pods depends on how many nodes your Kubernetes cluster have(e.g. 2 in this demo), so please make sure all "csi-nodeplugin" Pods are working properly.')]),e._v(" "),a("h2",{attrs:{id:"set-up-workspace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set-up-workspace"}},[e._v("#")]),e._v(" Set Up Workspace")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("any-path"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("/accelerate\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("any-path"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("/accelerate\n")])])]),a("h2",{attrs:{id:"install-resources-to-kubernetes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-resources-to-kubernetes"}},[e._v("#")]),e._v(" Install Resources to Kubernetes")]),e._v(" "),a("p",[a("strong",[e._v("Check the "),a("code",[e._v("Dataset")]),e._v(" object to be created")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ cat"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("EOF"),a("span",{pre:!0,attrs:{class:"token bash punctuation"}},[e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("dataset.yaml")]),e._v("\napiVersion: data.fluid.io/v1alpha1\nkind: Dataset\nmetadata:\n  name: hbase\nspec:\n  mounts:\n    - mountPoint: https://mirrors.tuna.tsinghua.edu.cn/apache/hbase/stable/\n      name: hbase\nEOF")]),e._v("\n")])])]),a("blockquote",[a("p",[e._v("Notes: Here, we use THU's tuna Apache mirror site as our "),a("code",[e._v("mountPoint")]),e._v(". If your environment isn't in Chinese mainland, please replace it with "),a("code",[e._v("https://downloads.apache.org/hbase/stable/")]),e._v(".")])]),e._v(" "),a("p",[e._v("Here, we'd like to create a resource object with kind "),a("code",[e._v("Dataset")]),e._v(". "),a("code",[e._v("Dataset")]),e._v(" is a Custom Resource Definition(CRD) defined by Fluid and used to tell Fluid where to find all the data you'd like to access.\nUnder the hood, Fluid uses Alluxio to do some mount operations, so "),a("code",[e._v("mountPoint")]),e._v(" property can be any legal UFS path acknowledged by Alluxio. Here, we use "),a("a",{attrs:{href:"https://docs.alluxio.io/os/user/stable/en/ufs/WEB.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("WebUFS"),a("OutboundLink")],1),e._v(" for its simplicity.")]),e._v(" "),a("p",[e._v("For more information about UFS, please refer to "),a("a",{attrs:{href:"https://docs.alluxio.io/os/user/stable/en/ufs/HDFS.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Alluxio Docs - Storage Integrations"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("For more information about properties in "),a("code",[e._v("Dataset")]),e._v(", please refer to our "),a("RouterLink",{attrs:{to:"/dev/api_doc.html"}},[e._v("API doc")])],1),e._v(" "),a("blockquote",[a("p",[e._v("We use hbase v2.2.5 on a mirror site of Apache downloads as an example of remote file. It's nothing special, you can change it to any remote file you like. But please note that, if you are going to use WebUFS like we do, files on Apache sites are highly recommended because you might need some "),a("a",{attrs:{href:"https://docs.alluxio.io/os/user/stable/en/ufs/WEB.html#configuring-alluxio",target:"_blank",rel:"noopener noreferrer"}},[e._v("advanced configurations"),a("OutboundLink")],1),e._v(" due to current implementation of WebUFS.")])]),e._v(" "),a("p",[a("strong",[e._v("Create the "),a("code",[e._v("Dataset")]),e._v(" object")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" dataset.yaml\ndataset.data.fluid.io/hbase created\n")])])]),a("p",[a("strong",[e._v("Check status of the "),a("code",[e._v("Dataset")]),e._v(" object")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get dataset hbase\nNAME    UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED PERCENTAGE   PHASE      AGE\nhbase                                                                  NotBound   13s\n")])])]),a("p",[e._v("With a "),a("code",[e._v("NotBound")]),e._v(" phase in status, the dataset is not ready cause there isn't any "),a("code",[e._v("AlluxioRuntime")]),e._v(" object supporting it. We'll create one in the following steps.")]),e._v(" "),a("p",[a("strong",[e._v("Check the "),a("code",[e._v("AlluxioRuntime")]),e._v(" object to be created")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ cat"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("EOF"),a("span",{pre:!0,attrs:{class:"token bash punctuation"}},[e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("runtime.yaml")]),e._v('\napiVersion: data.fluid.io/v1alpha1\nkind: AlluxioRuntime\nmetadata:\n  name: hbase\nspec:\n  replicas: 2\n  tieredstore:\n    levels:\n      - mediumtype: MEM\n        path: /dev/shm\n        quota: 2Gi\n        high: "0.95"\n        low: "0.7"\n  properties:\n    alluxio.user.block.size.bytes.default: 256MB\n    alluxio.user.streaming.reader.chunk.size.bytes: 256MB\n    alluxio.user.local.reader.chunk.size.bytes: 256MB\n    alluxio.worker.network.reader.buffer.size: 256MB\n    alluxio.user.streaming.data.timeout: 300sec\n  fuse:\n    args:\n      - fuse\n      - --fuse-opts=kernel_cache,ro,max_read=131072,attr_timeout=7200,entry_timeout=7200,nonempty,max_readahead=0\nEOF')]),e._v("\n")])])]),a("p",[a("strong",[e._v("Create a "),a("code",[e._v("AlluxioRuntime")]),e._v(" object")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" runtime.yaml\nalluxioruntime.data.fluid.io/hbase created\n")])])]),a("p",[a("strong",[e._v("Get the "),a("code",[e._v("AlluxioRuntime")]),e._v(" object")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get alluxioruntime\nNAME    AGE\nhbase   55s\n")])])]),a("p",[a("code",[e._v("AlluxioRuntime")]),e._v(" is another CRD defined by Fluid. An "),a("code",[e._v("AluxioRuntime")]),e._v(" object describes specifications used to run an Alluxio instance.")]),e._v(" "),a("p",[e._v("Wait for a while, and make sure all components defined in the "),a("code",[e._v("AlluxioRuntime")]),e._v(" object are ready. You shall see something like this:")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get pod\nNAME                 READY   STATUS    RESTARTS   AGE\nhbase-fuse-hvxgh     "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          27s\nhbase-fuse-sjhxk     "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          27s\nhbase-master-0       "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          62s\nhbase-worker-92cln   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          27s\nhbase-worker-rlb5w   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          27s\n")])])]),a("p",[a("strong",[e._v("Check status of the "),a("code",[e._v("Dataset")]),e._v(" object again")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get dataset hbase\nNAME    UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED PERCENTAGE   PHASE   AGE\nhbase   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("443")]),e._v(".5MiB         0B       4GiB             "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("%                  Bound   2m39s\n")])])]),a("p",[a("code",[e._v("Dataset")]),e._v(" object has been updated since a related Alluxio instance is ready and successfully bounded to the "),a("code",[e._v("Dataset")]),e._v(" object.")]),e._v(" "),a("p",[a("strong",[e._v("Check status of the "),a("code",[e._v("AlluxioRuntime")]),e._v(" object")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get alluxioruntime hbase "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-o")]),e._v(" wide\nNAME    READY MASTERS   DESIRED MASTERS   MASTER PHASE   READY WORKERS   DESIRED WORKERS   WORKER PHASE   READY FUSES   DESIRED FUSES   FUSE PHASE   AGE\nhbase   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("               "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("                 Ready          "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("               "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("                 Ready          "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("             "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("               Ready        2m50s\n")])])]),a("p",[e._v("Detailed information about the Alluxio instance is provided here.")]),e._v(" "),a("p",[a("strong",[e._v("Check related PersistentVolume and PersistentVolumeClaim")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("pv")]),e._v("\nNAME    CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM           STORAGECLASS   REASON   AGE\nhbase   100Gi      RWX            Retain           Bound    default/hbase                           18m\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get pvc\nNAME    STATUS   VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS   AGE\nhbase   Bound    hbase    100Gi      RWX                           18m\n")])])]),a("p",[e._v("Related PV and PVC have been created by Fluid since the "),a("code",[e._v("Dataset")]),e._v(" object is ready(bounded).\nWorkloads are now able to access remote files by mounting PVC.")]),e._v(" "),a("h2",{attrs:{id:"remote-file-access"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remote-file-access"}},[e._v("#")]),e._v(" Remote File Access")]),e._v(" "),a("p",[a("strong",[e._v("Check the app to be created")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ cat"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("EOF"),a("span",{pre:!0,attrs:{class:"token bash punctuation"}},[e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("nginx.yaml")]),e._v("\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\nspec:\n  containers:\n    - name: nginx\n      image: nginx\n      volumeMounts:\n        - mountPath: /data\n          name: hbase-vol\n  volumes:\n    - name: hbase-vol\n      persistentVolumeClaim:\n        claimName: hbase\nEOF")]),e._v("\n")])])]),a("p",[a("strong",[e._v("Run a demo app to access remote files")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" nginx.yaml\n")])])]),a("p",[e._v("Login to nginx Pod:")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exec")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-it")]),e._v(" nginx -- "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("bash")]),e._v("\n")])])]),a("p",[e._v("Check file status:")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("ls")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-1")]),e._v(" /data/hbase\nCHANGES.md\nRELEASENOTES.md\napi_compare_2.2.5RC0_to_2.2.4.html\nhbase-2.2.5-bin.tar.gz\nhbase-2.2.5-client-bin.tar.gz\nhbase-2.2.5-src.tar.gz\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("du")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-h")]),e._v(" /data/hbase/*\n174K    /data/hbase/CHANGES.md\n106K    /data/hbase/RELEASENOTES.md\n115K    /data/hbase/api_compare_2.2.5RC0_to_2.2.4.html\n211M    /data/hbase/hbase-2.2.5-bin.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(".0K    /data/hbase/hbase-2.2.5-bin.tar.gz.asc\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("512")]),e._v("     /data/hbase/hbase-2.2.5-bin.tar.gz.sha512\n200M    /data/hbase/hbase-2.2.5-client-bin.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(".0K    /data/hbase/hbase-2.2.5-client-bin.tar.gz.asc\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("512")]),e._v("     /data/hbase/hbase-2.2.5-client-bin.tar.gz.sha512\n34M     /data/hbase/hbase-2.2.5-src.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(".0K    /data/hbase/hbase-2.2.5-src.tar.gz.asc\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("512")]),e._v("     /data/hbase/hbase-2.2.5-src.tar.gz.sha512\n")])])]),a("p",[e._v("Logout:")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exit")]),e._v("\n")])])]),a("p",[e._v("As you may have seen, all the files on the WebUFS(e.g. hbase-related files on Apache mirror in our case) appear no differences from any other file in the local filesystem of the nginx Pod.")]),e._v(" "),a("h2",{attrs:{id:"speed-up-accessing-remote-files"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#speed-up-accessing-remote-files"}},[e._v("#")]),e._v(" Speed Up Accessing Remote Files")]),e._v(" "),a("p",[e._v("To demonstrate how great speedup you may enjoy when accessing remote files, here is a demo job:")]),e._v(" "),a("p",[a("strong",[e._v("Check the test job to be launched")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ cat"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("EOF"),a("span",{pre:!0,attrs:{class:"token bash punctuation"}},[e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("app.yaml")]),e._v('\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: fluid-copy-test\nspec:\n  template:\n    spec:\n      restartPolicy: OnFailure\n      containers:\n        - name: busybox\n          image: busybox\n          command: ["/bin/sh"]\n          args: ["-c", "set -x; time cp -r /data/hbase ./"]\n          volumeMounts:\n            - mountPath: /data\n              name: hbase-vol\n      volumes:\n        - name: hbase-vol\n          persistentVolumeClaim:\n            claimName: hbase\nEOF')]),e._v("\n")])])]),a("p",[a("strong",[e._v("Launch a test job")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" app.yaml\njob.batch/fluid-test created\n")])])]),a("p",[e._v("Under the hood, the test job executes a shell command "),a("code",[e._v("time cp -r /data/hbase ./")]),e._v(" and prints its result.\nWait for a while and make sure the job has completed. You can check its runnning status by:")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get pod\nNAME                    READY   STATUS      RESTARTS   AGE\nfluid-copy-test-h59w9   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("/1     Completed   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          1m25s\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])])]),a("blockquote",[a("p",[e._v("Note: the "),a("code",[e._v("h59w9")]),e._v(" in "),a("code",[e._v("fluid-copy-test-h59w9")]),e._v(" is a specifier generated by the Job we created. It's highly possible that you may have different specifier in your environment. Please remember replace it with your own specifier in the following steps")])]),e._v(" "),a("p",[a("strong",[e._v("Check running time of the test job")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl logs fluid-copy-test-h59w9\n+ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("time")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-r")]),e._v(" /data/hbase ./\nreal  1m "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(".74s\nuser  0m "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(".00s\nsys   0m "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(".35s\n")])])]),a("p",[e._v("It's our first time to read such a file, and it takes us about 63s. It may be not as fast as you expected but:")]),e._v(" "),a("p",[a("strong",[e._v("Check status of the dataset")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get dataset hbase\nNAME    UFS TOTAL SIZE   CACHED     CACHE CAPACITY   CACHED PERCENTAGE   PHASE   AGE\nhbase   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("443")]),e._v(".5MiB         "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("443")]),e._v(".5MiB   4GiB             "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("%                Bound   9m27s\n")])])]),a("p",[e._v("Now, all the remote files have been cached in Alluxio.")]),e._v(" "),a("p",[a("strong",[e._v("Re-Launch the test job")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl delete "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" app.yaml\n$ kubectl create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" app.yaml\n")])])]),a("p",[e._v("It'll finish very soon after creation this time:")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get pod\nNAME                    READY   STATUS      RESTARTS   AGE\nfluid-copy-test-d9h2x   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("/1     Completed   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          24s\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl logs fluid-copy-test-d9h2x\n+ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("time")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-r")]),e._v(" /data/hbase ./\nreal  0m "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(".94s\nuser  0m "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(".00s\nsys   0m "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(".27s\n")])])]),a("p",[e._v("The same read operation takes only 3s this time.")]),e._v(" "),a("p",[e._v("The great speedup attributes to the powerful caching capability provided by Alluxio. That means that once you access some remote file, it will be cached in Alluxio, and your next following operations will enjoy a local access instead of a remote one, and thus a great speedup.")]),e._v(" "),a("blockquote",[a("p",[e._v("Note: Time spent for the test job depends on your network environment. If it takes too long for you to complete the job, changing a mirror or some smaller file might help.")])]),e._v(" "),a("h2",{attrs:{id:"clean-up"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clean-up"}},[e._v("#")]),e._v(" Clean Up")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl delete "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);