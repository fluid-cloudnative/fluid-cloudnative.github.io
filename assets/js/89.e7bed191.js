(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{451:function(a,s,e){"use strict";e.r(s);var t=e(19),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"示例-单机多dataset远程web文件访问加速"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例-单机多dataset远程web文件访问加速"}},[a._v("#")]),a._v(" 示例 - 单机多Dataset远程Web文件访问加速")]),a._v(" "),s("p",[a._v("通过"),s("a",{attrs:{href:"https://www.alluxio.io",target:"_blank",rel:"noopener noreferrer"}},[a._v("Alluxio"),s("OutboundLink")],1),a._v("和"),s("a",{attrs:{href:"https://github.com/libfuse/libfuse",target:"_blank",rel:"noopener noreferrer"}},[a._v("Fuse"),s("OutboundLink")],1),a._v("，Fluid为用户提供了一种更为简单的文件访问接口，使得任意运行在Kubernetes集群上的程序能够像访问本地文件一样轻松访问存储在远程文件系统中的文件。Fluid 针对数据集进行全生命周期的管理和隔离，尤其对于短生命周期应用（e.g 数据分析任务、机器学习任务），用户可以在集群中大规模部署。")]),a._v(" "),s("p",[a._v("本文档通过一个简单的例子演示了上述功能特性")]),a._v(" "),s("h2",{attrs:{id:"前提条件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前提条件"}},[a._v("#")]),a._v(" 前提条件")]),a._v(" "),s("p",[a._v("在运行该示例之前，请参考"),s("RouterLink",{attrs:{to:"/zh/userguide/install.html"}},[a._v("安装文档")]),a._v("完成安装，并检查Fluid各组件正常运行：")],1),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get pod "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-n")]),a._v(" fluid-system\nNAME                                  READY   STATUS    RESTARTS   AGE\nalluxioruntime-controller-5b64fdbbb-84pc6   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          8h\ncsi-nodeplugin-fluid-fwgjh                  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          8h\ncsi-nodeplugin-fluid-ll8bq                  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          8h\ndataset-controller-5b7848dbbb-n44dj         "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          8h\n")])])]),s("p",[a._v("通常来说，你会看到一个名为"),s("code",[a._v("dataset-controller")]),a._v("的Pod、一个名为"),s("code",[a._v("alluxioruntime-controller")]),a._v("的Pod和多个名为"),s("code",[a._v("csi-nodeplugin")]),a._v("的Pod正在运行。其中，"),s("code",[a._v("csi-nodeplugin")]),a._v("这些Pod的数量取决于你的Kubernetes集群中结点的数量。")]),a._v(" "),s("h2",{attrs:{id:"运行示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行示例"}},[a._v("#")]),a._v(" 运行示例")]),a._v(" "),s("p",[s("strong",[a._v("对某个节点打标签")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl  label "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("node")]),a._v(" cn-beijing.192.168.0.199 "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("fluid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("multi-dataset\n")])])]),s("blockquote",[s("p",[a._v("在接下来的步骤中，我们将使用 "),s("code",[a._v("NodeSelector")]),a._v(" 来管理Dataset调度的节点，这里仅做试验使用。")])]),a._v(" "),s("p",[s("strong",[a._v("查看待创建的Dataset资源对象")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ cat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF"),s("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("dataset.yaml")]),a._v('\napiVersion: data.fluid.io/v1alpha1\nkind: Dataset\nmetadata:\n  name: hbase\nspec:\n  mounts:\n    - mountPoint: https://mirrors.tuna.tsinghua.edu.cn/apache/hbase/stable/\n      name: hbase\n  nodeAffinity:\n    required:\n      nodeSelectorTerms:\n        - matchExpressions:\n            - key: fluid\n              operator: In\n              values:\n                - "multi-dataset"\n  placement: "Shared" // 设置为 Exclusive 或者为空则为独占节点数据集\n\nEOF')]),a._v("\n\n$ cat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF"),s("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("dataset1.yaml")]),a._v('\napiVersion: data.fluid.io/v1alpha1\nkind: Dataset\nmetadata:\n  name: spark\nspec:\n  mounts:\n    - mountPoint: https://mirrors.bit.edu.cn/apache/spark/\n      name: spark\n  nodeAffinity:\n    required:\n      nodeSelectorTerms:\n        - matchExpressions:\n            - key: fluid\n              operator: In\n              values:\n                - "multi-dataset"\n  placement: "Shared" \n\nEOF')]),a._v("        \n")])])]),s("blockquote",[s("p",[a._v("注意: 上述mountPoint中使用了Apache清华镜像源进行演示，如果你的环境位于海外，请更换为"),s("code",[a._v("https://downloads.apache.org/hbase/stable/")]),a._v("和"),s("code",[a._v("https://downloads.apache.org/spark/")]),a._v("进行尝试")])]),a._v(" "),s("p",[a._v("在这里，我们将要创建一个kind为"),s("code",[a._v("Dataset")]),a._v("的资源对象(Resource object)。"),s("code",[a._v("Dataset")]),a._v("是Fluid所定义的一个Custom Resource Definition(CRD)，该CRD被用来告知Fluid在哪里可以找到你所需要的数据。Fluid将该CRD对象中定义的"),s("code",[a._v("mountPoint")]),a._v("属性挂载到Alluxio之上，因此该属性可以是任何合法的能够被Alluxio识别的UFS地址。在本示例中，为了简单，我们使用"),s("a",{attrs:{href:"https://docs.alluxio.io/os/user/stable/cn/ufs/WEB.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("WebUFS"),s("OutboundLink")],1),a._v("进行演示。")]),a._v(" "),s("p",[a._v("更多有关UFS的信息，请参考"),s("a",{attrs:{href:"https://docs.alluxio.io/os/user/stable/cn/ufs/OSS.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Alluxio文档-底层存储系统"),s("OutboundLink")],1),a._v("部分。")]),a._v(" "),s("blockquote",[s("p",[a._v("本示例将以Apache镜像站点上的Hbase stable和Spark相关资源作为演示中使用的远程文件。这个选择并没有任何特殊之处，你可以将这个远程文件修改为任意你喜欢的远程文件。但是，如果你想要和我们一样使用WebUFS进行操作的话，最好还是选择一个Apache镜像源站点( e.g. "),s("a",{attrs:{href:"https://mirrors.tuna.tsinghua.edu.cn/apache",target:"_blank",rel:"noopener noreferrer"}},[a._v("清华镜像源"),s("OutboundLink")],1),a._v(" )，因为根据目前WebUFS的实现，如果你选择其他更加复杂的网页作为WebUFS，你可能需要进行更多"),s("a",{attrs:{href:"https://docs.alluxio.io/os/user/stable/cn/ufs/WEB.html#%E9%85%8D%E7%BD%AEalluxio",target:"_blank",rel:"noopener noreferrer"}},[a._v("更复杂的配置"),s("OutboundLink")],1)])]),a._v(" "),s("p",[s("strong",[a._v("创建Dataset资源对象")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl apply "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" dataset.yaml\ndataset.data.fluid.io/hbase created\n$ kubectl apply "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" dataset1.yaml\ndataset.data.fluid.io/spark created\n")])])]),s("p",[s("strong",[a._v("查看Dataset资源对象状态")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get dataset\nNAME    UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED PERCENTAGE   PHASE      AGE\nhbase                                                                  NotBound   6s\nspark                                                                  NotBound   4s\n")])])]),s("p",[a._v("如上所示，"),s("code",[a._v("status")]),a._v("中的"),s("code",[a._v("phase")]),a._v("属性值为"),s("code",[a._v("NotBound")]),a._v("，这意味着该"),s("code",[a._v("Dataset")]),a._v("资源对象目前还未与任何"),s("code",[a._v("AlluxioRuntime")]),a._v("资源对象绑定，接下来，我们将创建一个"),s("code",[a._v("AlluxioRuntime")]),a._v("资源对象。")]),a._v(" "),s("p",[s("strong",[a._v("查看待创建的AlluxioRuntime资源对象")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ cat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF"),s("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("runtime.yaml")]),a._v('\napiVersion: data.fluid.io/v1alpha1\nkind: AlluxioRuntime\nmetadata:\n  name: hbase\nspec:\n  replicas: 1\n  tieredstore:\n    levels:\n      - mediumtype: MEM\n        path: /dev/shm\n        quota: 2Gi\n        high: "0.95"\n        low: "0.7"\n      \nEOF')]),a._v("\n\n$ cat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF"),s("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("runtime1.yaml")]),a._v('\napiVersion: data.fluid.io/v1alpha1\nkind: AlluxioRuntime\nmetadata:\n  name: spark\nspec:\n  replicas: 1\n  tieredstore:\n    levels:\n      - mediumtype: MEM\n        path: /dev/shm\n        quota: 4Gi\n        high: "0.95"\n        low: "0.7"\n\nEOF')]),a._v("\n")])])]),s("p",[s("strong",[a._v("创建AlluxioRuntime资源对象")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" runtime.yaml\nalluxioruntime.data.fluid.io/hbase created\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 注意等待 Dataset hbase 全部组件 Running ")]),a._v("\n$ kubectl get pod "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" wide "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" hbase\nNAME                 READY   STATUS    RESTARTS   AGE   IP              NODE                       NOMINATED NODE   READINESS GATES\nhbase-fuse-jl2g2     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          2m24s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.199   cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nhbase-master-0       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          2m55s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.200   cn-beijing.192.168.0.200   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nhbase-worker-g89p8   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          2m24s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.199   cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n$ kubectl create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" runtime1.yaml\nalluxioruntime.data.fluid.io/spark created\n")])])]),s("p",[s("strong",[a._v("检查AlluxioRuntime资源对象是否已经创建")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get alluxioruntime\nNAME    MASTER PHASE   WORKER PHASE   FUSE PHASE   AGE\nhbase   Ready          Ready          Ready        2m14s\nspark   Ready          Ready          Ready        58s\n")])])]),s("p",[s("code",[a._v("AlluxioRuntime")]),a._v("是另一个Fluid定义的CRD。一个"),s("code",[a._v("AlluxioRuntime")]),a._v("资源对象描述了在Kubernetes集群中运行一个Alluxio实例所需要的配置信息。")]),a._v(" "),s("p",[a._v("等待一段时间，让AlluxioRuntime资源对象中的各个组件得以顺利启动，你会看到类似以下状态：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get pod "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" wide\nNAME                 READY   STATUS    RESTARTS   AGE     IP              NODE                       NOMINATED NODE   READINESS GATES\nhbase-fuse-jl2g2     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          2m24s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.199   cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nhbase-master-0       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          2m55s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.200   cn-beijing.192.168.0.200   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nhbase-worker-g89p8   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          2m24s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.199   cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nspark-fuse-5z49p     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          19s     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.199   cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nspark-master-0       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          50s     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.200   cn-beijing.192.168.0.200   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nspark-worker-96ksn   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          19s     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.199   cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),s("p",[a._v("注意上面的不同的 Dataset 的 worker 和 fuse 组件可以正常的调度到相同的节点 "),s("code",[a._v("cn-beijing.192.168.0.199")]),a._v("。")]),a._v(" "),s("p",[s("strong",[a._v("再次查看Dataset资源对象状态")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get dataset \nNAME    UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED PERCENTAGE   PHASE   AGE\nhbase   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("443")]),a._v(".89MiB        "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".00B    "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(".00GiB          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),a._v("%                Bound   11m\nspark   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".92GiB          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".00B    "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v(".00GiB          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),a._v("%                Bound   9m38s\n")])])]),s("p",[a._v("因为已经与一个成功启动的AlluxioRuntime绑定，该Dataset资源对象的状态得到了更新，此时"),s("code",[a._v("PHASE")]),a._v("属性值已经变为"),s("code",[a._v("Bound")]),a._v("状态。通过上述命令可以获知有关资源对象的基本信息")]),a._v(" "),s("p",[s("strong",[a._v("查看AlluxioRuntime状态")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get alluxioruntime "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" wide\nNAME    READY MASTERS   DESIRED MASTERS   MASTER PHASE   READY WORKERS   DESIRED WORKERS   WORKER PHASE   READY FUSES   DESIRED FUSES   FUSE PHASE   AGE\nhbase   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("               "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("                 Ready          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("               "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("                 Ready          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("             "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("               Ready        11m\nspark   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("               "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("                 Ready          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("               "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("                 Ready          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("             "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("               Ready        9m52s\n")])])]),s("p",[s("code",[a._v("AlluxioRuntime")]),a._v("资源对象的"),s("code",[a._v("status")]),a._v("中包含了更多更详细的信息")]),a._v(" "),s("p",[s("strong",[a._v("查看与远程文件关联的PersistentVolume以及PersistentVolumeClaim")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("pv")]),a._v("\nNAME    CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM           STORAGECLASS   REASON   AGE\nhbase   100Gi      RWX            Retain           Bound    default/hbase                           4m55s\nspark   100Gi      RWX            Retain           Bound    default/spark                           51s\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get pvc\nNAME    STATUS   VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS   AGE\nhbase   Bound    hbase    100Gi      RWX                           4m57s\nspark   Bound    spark    100Gi      RWX                           53s\n")])])]),s("p",[s("code",[a._v("Dataset")]),a._v("资源对象准备完成后（即与Alluxio实例绑定后），与该资源对象关联的PV, PVC已经由Fluid生成，应用可以通过该PVC完成远程文件在Pod中的挂载，并通过挂载目录实现远程文件访问")]),a._v(" "),s("h2",{attrs:{id:"远程文件访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#远程文件访问"}},[a._v("#")]),a._v(" 远程文件访问")]),a._v(" "),s("p",[s("strong",[a._v("查看待创建的应用")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ cat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF"),s("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("nginx.yaml")]),a._v("\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-hbase\nspec:\n  containers:\n    - name: nginx\n      image: nginx\n      volumeMounts:\n        - mountPath: /data\n          name: hbase-vol\n  volumes:\n    - name: hbase-vol\n      persistentVolumeClaim:\n        claimName: hbase\n  nodeName: cn-beijing.192.168.0.199\n\nEOF")]),a._v("\n\n$ cat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF"),s("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("nginx1.yaml")]),a._v("\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-spark\nspec:\n  containers:\n    - name: nginx\n      image: nginx\n      volumeMounts:\n        - mountPath: /data\n          name: hbase-vol\n  volumes:\n    - name: hbase-vol\n      persistentVolumeClaim:\n        claimName: spark\n  nodeName: cn-beijing.192.168.0.199\n\nEOF")]),a._v("\n")])])]),s("p",[s("strong",[a._v("启动应用进行远程文件访问")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" nginx.yaml\n$ kubectl create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" nginx1.yaml\n")])])]),s("p",[a._v("登录Nginx hbase Pod:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" nginx-hbase -- "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v("\n")])])]),s("p",[a._v("查看远程文件挂载情况：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-lh")]),a._v(" /data/hbase\ntotal 444M\n-r--r----- "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 193K Sep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(" 00:53 CHANGES.md\n-r--r----- "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 112K Sep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(" 00:53 RELEASENOTES.md\n-r--r----- "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root  26K Sep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(" 00:53 api_compare_2.2.6RC2_to_2.2.5.html\n-r--r----- "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 211M Sep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(" 00:53 hbase-2.2.6-bin.tar.gz\n-r--r----- "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 200M Sep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(" 00:53 hbase-2.2.6-client-bin.tar.gz\n-r--r----- "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root  34M Sep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(" 00:53 hbase-2.2.6-src.tar.gz\n")])])]),s("p",[a._v("登录Nginx spark Pod:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" nginx-spark -- "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v("\n")])])]),s("p",[a._v("查看远程文件挂载情况：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-lh")]),a._v(" /data/spark/\ntotal "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".0K\ndr--r----- "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v(" Oct "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v(":21 spark-2.4.7\ndr--r----- "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v(" Oct "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v(":21 spark-3.0.1\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("du")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v(" /data/spark/\n999M\t/data/spark/spark-3.0.1\n968M\t/data/spark/spark-2.4.7\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(".0G\t/data/spark/\n")])])]),s("p",[a._v("登出Nginx Pod:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),a._v("\n")])])]),s("p",[a._v("正如你所见，WebUFS上所存储的全部文件,可以和本地文件完全没有区别的方式存在于某个Pod中，并且可以被该Pod十分方便地访问")]),a._v(" "),s("h2",{attrs:{id:"远程文件访问加速"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#远程文件访问加速"}},[a._v("#")]),a._v(" 远程文件访问加速")]),a._v(" "),s("p",[a._v("为了演示在访问远程文件时，你能获得多大的加速效果，我们提供了一个测试作业的样例:")]),a._v(" "),s("p",[s("strong",[a._v("查看待创建的测试作业")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ cat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF"),s("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("app.yaml")]),a._v('\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: fluid-copy-test-hbase\nspec:\n  template:\n    spec:\n      restartPolicy: OnFailure\n      containers:\n        - name: busybox\n          image: busybox\n          command: ["/bin/sh"]\n          args: ["-c", "set -x; time cp -r /data/hbase ./"]\n          volumeMounts:\n            - mountPath: /data\n              name: hbase-vol\n      volumes:\n        - name: hbase-vol\n          persistentVolumeClaim:\n            claimName: hbase\n      nodeName: cn-beijing.192.168.0.199\n\nEOF')]),a._v("\n\n$ cat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF"),s("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("app1.yaml")]),a._v('\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: fluid-copy-test-spark\nspec:\n  template:\n    spec:\n      restartPolicy: OnFailure\n      containers:\n        - name: busybox\n          image: busybox\n          command: ["/bin/sh"]\n          args: ["-c", "set -x; time cp -r /data/spark ./"]\n          volumeMounts:\n            - mountPath: /data\n              name: spark-vol\n      volumes:\n        - name: spark-vol\n          persistentVolumeClaim:\n            claimName: spark\n      nodeName: cn-beijing.192.168.0.199\n\nEOF')]),a._v("\n")])])]),s("p",[s("strong",[a._v("启动测试作业")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" app.yaml\njob.batch/fluid-copy-test-hbase created\n$ kubectl create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" app1.yaml\njob.batch/fluid-copy-test-spark created\n")])])]),s("p",[a._v("hbase任务程序会执行"),s("code",[a._v("time cp -r /data/hbase ./")]),a._v("的shell命令，其中"),s("code",[a._v("/data/hbase")]),a._v("是远程文件在Pod中挂载的位置，该命令完成后会在终端显示命令执行的时长。")]),a._v(" "),s("p",[a._v("spark任务程序会执行"),s("code",[a._v("time cp -r /data/spark ./")]),a._v("的shell命令，其中"),s("code",[a._v("/data/spark")]),a._v("是远程文件在Pod中挂载的位置，该命令完成后会在终端显示命令执行的时长。")]),a._v(" "),s("p",[a._v("等待一段时间,待该作业运行完成,作业的运行状态可通过以下命令查看:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get pod "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" wide "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" copy \nfluid-copy-test-hbase-r8gxp   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("/1     Completed   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          4m16s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.29")]),a._v(".0.135    cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nfluid-copy-test-spark-54q8m   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("/1     Completed   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          4m14s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.29")]),a._v(".0.136    cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),s("p",[a._v("如果看到如上结果,则说明该作业已经运行完成")]),a._v(" "),s("blockquote",[s("p",[a._v("注意: "),s("code",[a._v("fluid-copy-test-hbase-r8gxp")]),a._v("中的"),s("code",[a._v("r8gxp")]),a._v("为作业生成的标识,在你的环境中,这个标识可能不同,接下来的命令中涉及该标识的地方请以你的环境为准")])]),a._v(" "),s("p",[s("strong",[a._v("查看测试作业完成时间")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl  logs fluid-copy-test-hbase-r8gxp\n+ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("time")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" /data/hbase ./\nreal    3m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("34")]),a._v(".08s\nuser    0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".00s\nsys     0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".24s\n$ kubectl  logs fluid-copy-test-spark-54q8m\n+ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("time")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" /data/spark ./\nreal    3m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("25")]),a._v(".47s\nuser    0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".00s\nsys     0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(".48s\n")])])]),s("p",[a._v("可见，第一次远程文件的读取hbase耗费了接3m34s的时间，读取spark耗费接近3m25s时间。")]),a._v(" "),s("p",[s("strong",[a._v("查看Dataset资源对象状态")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get dataset\nNAME    UFS TOTAL SIZE   CACHED      CACHE CAPACITY   CACHED PERCENTAGE   PHASE   AGE\nhbase   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("443")]),a._v(".89MiB        "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("443")]),a._v(".89MiB   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(".00GiB          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100.0")]),a._v("%              Bound   30m\nspark   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".92GiB          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".92GiB     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v(".00GiB          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100.0")]),a._v("%              Bound   28m\n")])])]),s("p",[a._v("现在，所有远程文件都已经被缓存在了Alluxio中")]),a._v(" "),s("p",[s("strong",[a._v("再次启动测试作业")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl delete "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" app.yaml\n$ kubectl create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" app.yaml\n$ kubectl delete "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" app1.yaml\n$ kubectl create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" app1.yaml\n")])])]),s("p",[a._v("由于远程文件已经被缓存，此次测试作业能够迅速完成：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl get pod "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" wide"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" fluid\nfluid-copy-test-hbase-sf5md   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("/1     Completed   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          53s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.29")]),a._v(".0.137    cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nfluid-copy-test-spark-fwp57   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("/1     Completed   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          51s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.29")]),a._v(".0.138    cn-beijing.192.168.0.199   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl  logs fluid-copy-test-hbase-sf5md\n+ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("time")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" /data/hbase ./\nreal    0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".36s\nuser    0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".00s\nsys     0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".36s\n$ kubectl  logs fluid-copy-test-spark-fwp57\n+ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("time")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" /data/spark ./\nreal    0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".57s\nuser    0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".00s\nsys     0m "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".57s\n")])])]),s("p",[a._v("同样的文件访问操，hbase仅耗费了0.36s，spark仅耗费了1.57s。")]),a._v(" "),s("p",[a._v("这种大幅度的加速效果归因于Alluxio所提供的强大的缓存能力，这种缓存能力意味着，只要你访问某个远程文件一次，该文件就会被缓存在Alluxio中，你的所有接下来的重复访问都不再需要进行远程文件读取，而是从Alluxio中直接获取数据，因此对于数据的访问加速也就不难解释了。")]),a._v(" "),s("blockquote",[s("p",[a._v("注意： 上述文件的访问速度与示例运行环境的网络条件有关，如果文件访问速度过慢，请更换更小的远程文件尝试")])]),a._v(" "),s("p",[a._v("同样登录主机节点（如果可以）")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v(" root@192.168.0.199\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" /dev/shm/default/\nhbase  spark\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-lh")]),a._v(" /dev/shm/default/hbase/alluxioworker/\n总用量 444M\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 174K "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v(":27 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100663296")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 115K "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v(":27 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16777216")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 200M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v(":26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("33554432")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 106K "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v(":26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("50331648")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 211M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v(":27 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("67108864")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root  34M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v(":27 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("83886080")]),a._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-lh")]),a._v(" /dev/shm/default/spark/alluxioworker/\n总用量 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(".0G\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 210M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":06 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100663296")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root  16M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":07 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("117440512")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 195M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":05 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("134217728")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 214M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":05 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("150994944")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 140M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":08 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16777216")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root  22M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":05 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("167772160")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 221M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":07 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("184549376")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 150M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":06 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("201326592")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 311K "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":07 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("218103808")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 322K "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":06 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("234881024")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 210M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":06 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("33554432")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 161M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":07 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("50331648")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 223M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":07 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("67108864")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rwxrwxrwx")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root 208M "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":07 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("83886080")]),a._v("\n")])])]),s("p",[a._v("可以看到不同Dataset缓存的block文件根据Dataset的namespace和name进行了隔离。")]),a._v(" "),s("h2",{attrs:{id:"环境清理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境清理"}},[a._v("#")]),a._v(" 环境清理")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ kubectl delete "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n$ kubectl label "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("node")]),a._v(" cn-beijing.192.168.0.199 fluid-\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);